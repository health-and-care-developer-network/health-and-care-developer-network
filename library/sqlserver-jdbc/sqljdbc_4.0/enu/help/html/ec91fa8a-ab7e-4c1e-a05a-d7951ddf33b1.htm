<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Connecting with SSL Encryption</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="encryption" /><meta name="System.Keywords" content="SSL" /><meta name="Microsoft.Help.Id" content="ec91fa8a-ab7e-4c1e-a05a-d7951ddf33b1" /><meta name="Description" content="The examples in this topic describe how to use connection string properties that allow applications to use Secure Sockets Layer (SSL) encryption in a Java application." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Connecting with SSL Encryption</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>The examples in this topic describe how to use connection string properties that allow applications to use Secure Sockets Layer (SSL) encryption in a Java application. For more information about these new connection string properties such as <span class="label">encrypt</span>, <span class="label">trustServerCertificate</span>, <span class="label">trustStore</span>, <span class="label">trustStorePassword</span>, and <span class="label">hostNameInCertificate</span>, see <span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">Setting the Connection Properties</a></span>.</p><p>When the <span class="label">encrypt</span> property is set to <span sdata="langKeyword" value="true"><span class="keyword">true</span></span> and the <span class="label">trustServerCertificate</span> property is set to <span sdata="langKeyword" value="true"><span class="keyword">true</span></span>, the Microsoft JDBC Driver for SQL Server will not validate the SQL Server SSL certificate. This is usually required for allowing connections in test environments, such as where the SQL Server instance has only a self signed certificate.</p><p>The following code example demonstrates how to set the <span class="label">trustServerCertificate</span> property in a connection string:</p><div class="sampleCode"><span codeLanguage="other"><pre>String connectionUrl = 
    "jdbc:sqlserver://localhost:1433;" +
     "databaseName=AdventureWorks;integratedSecurity=true;" +
     "encrypt=true;trustServerCertificate=true";</pre></span></div><p>When the <span class="label">encrypt</span> property is set to <span sdata="langKeyword" value="true"><span class="keyword">true</span></span> and the <span class="label">trustServerCertificate</span> property is set to <span sdata="langKeyword" value="false"><span class="keyword">false</span></span>, the Microsoft JDBC Driver for SQL Server will validate the SQL Server SSL certificate. Validating the server certificate is a part of the SSL handshake and ensures that the server is the correct server to connect to. In order to validate the server certificate, the trust material must be supplied at connection time either by using <span class="label">trustStore</span> and <span class="label">trustStorePassword</span> connection properties explicitly, or by using the underlying Java Virtual Machine (JVM)'s default trust store implicitly. </p><p>The <span class="label">trustStore</span> property specifies the path (including filename) to the certificate trustStore file, which contains the list of certificates that the client trusts. The <span class="label">trustStorePassword</span> property specifies the password used to check the integrity of the trustStore data. For more information on using the JVM's default trust store, see the <span sdata="link"><a href="ae34cd1f-3569-4759-80c7-7c9b33b3e9eb.htm">Configuring the Client for SSL Encryption</a></span>.</p><p>The following code example demonstrates how to set the <span class="label">trustStore</span> and <span class="label">trustStorePassword</span> properties in a connection string: </p><div class="sampleCode"><span codeLanguage="other"><pre>String connectionUrl = 
    "jdbc:sqlserver://localhost:1433;" +
     "databaseName=AdventureWorks;integratedSecurity=true;" +
     "encrypt=true; trustServerCertificate=false;" +
     "trustStore=storeName;trustStorePassword=storePassword";</pre></span></div><p>The JDBC Driver provides an additional property, <span class="label">hostNameInCertificate</span>, which specifies the host name of the server. The value of this property must match the subject property of the certificate. </p><p>The following code example demonstrates how to use the <span class="label">hostNameInCertificate</span> property in a connection string:</p><div class="sampleCode"><span codeLanguage="other"><pre>String connectionUrl = 
    "jdbc:sqlserver://localhost:1433;" +
     "databaseName=AdventureWorks;integratedSecurity=true;" +
     "encrypt=true; trustServerCertificate=false;" +
     "trustStore=storeName;trustStorePassword=storePassword" +
     "hostNameInCertificate=hostName";</pre></span></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Alternatively, you can set the value of connection properties by using the appropriate <span sdata="langKeyword" value="setter"><span class="keyword">setter</span></span> methods provided by the <a href="097434fd-2b74-411c-a5ed-eba04481dde5.htm">SQLServerDataSource</a> class.</p></div><p>If the <span class="label">encrypt</span> property is set to <span sdata="langKeyword" value="true"><span class="keyword">true</span></span> and the <span class="label">trustServerCertificate</span> property is set to <span sdata="langKeyword" value="false"><span class="keyword">false</span></span> and if the server name in the connection string does not match the server name in the SQL Server SSL certificate, the following error will be issued: The driver could not establish a secure connection to SQL Server by using Secure Sockets Layer (SSL) encryption. Error: "java.security.cert.CertificateException: Failed to validate the server name in a certificate during Secure Sockets Layer (SSL) initialization."</p></div><span id="seeAlsoSpan"><h1 class="heading">See Also</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="8e566243-2f93-4b21-8065-3c8336649309.htm">Using SSL Encryption</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="90724ec6-a9cb-43ef-903e-793f89410bc0.htm">Securing JDBC Driver Applications</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Send <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','01.00.12024.10000','%0\dThank%20you%20for%20your%20feedback.%20The%20developer%20writing%20teams%20use%20your%20feedback%20to%20improve%20documentation.%20While%20we%20are%20reviewing%20your%20feedback,%20we%20may%20send%20you%20e-mail%20to%20ask%20for%20clarification%20or%20feedback%20on%20a%20solution.%20We%20do%20not%20use%20your%20e-mail%20address%20for%20any%20other%20purpose%20and%20we%20delete%20it%20after%20we%20finish%20our%20review.%0\AFor%20further%20information%20about%20the%20privacy%20policies%20of%20Microsoft,%20please%20see%20http://privacy.microsoft.com/en-us/default.aspx.%0\A%0\d','Customer%20Feedback');">feedback</a> on this topic to Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.  All rights reserved.</a></p></span></div></div></body></html>