<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Configuring the Client for SSL Encryption</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="certificate" /><meta name="System.Keywords" content="configuring SSL certificate" /><meta name="System.Keywords" content="SSL" /><meta name="System.Keywords" content="SSL certificate" /><meta name="Microsoft.Help.Id" content="ae34cd1f-3569-4759-80c7-7c9b33b3e9eb" /><meta name="Description" content="The Microsoft JDBC Driver for SQL Server or client has to validate that the server is the correct server and its certificate is issued by a certificate authority that the client trusts." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Configuring the Client for SSL Encryption</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>The Microsoft JDBC Driver for SQL Server or client has to validate that the server is the correct server and its certificate is issued by a certificate authority that the client trusts. In order to validate the server certificate, the trust material must be supplied at connection time. In addition, the issuer of the server certificate must be a certificate authority that the client trusts.</p><p>This topic first describes how to supply the trust material in the client computer. Then, the topic describes how to import a server certificate to the client computer's trust store when the instance of SQL Server's Secure Sockets Layer (SSL) certificate is issued by a private certificate authority.</p><p>For more information about validating the server certificate, see the Validating Server SSL Certificate section in <span sdata="link"><a href="073f3b9e-8edd-4815-88ea-de0655d0325e.htm">Understanding SSL Support</a></span>.</p></div><h1 class="heading">Configuring the Client Trust Store</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Validating the server certificate requires that the trust material must be supplied at connection time either by using <span class="label">trustStore</span> and <span class="label">trustStorePassword</span> connection properties explicitly, or by using the underlying Java Virtual Machine (JVM)'s default trust store implicitly. For more information about how to set the <span class="label">trustStore</span> and <span class="label">trustStorePassword</span> properties in a connection string, see <span sdata="link"><a href="ec91fa8a-ab7e-4c1e-a05a-d7951ddf33b1.htm">Connecting with SSL Encryption</a></span>.</p><p>If the <span class="label">trustStore</span> property is unspecified or set to null, the Microsoft JDBC Driver for SQL Server will rely on the underlying JVM's security provider, the Java Secure Socket Extension (SunJSSE). The SunJSSE provider provides a default <b>TrustManager</b>, which is used to validate X.509 certificates returned by SQL Server against the trust material provided in a trust store.</p><p>The <b>TrustManager</b> tries to locate the default trustStore in the following search order:</p><ul><li><p>If the system property "javax.net.ssl.trustStore" is defined, the <b>TrustManager</b> tries to find the default trustStore file by using the filename specified by that system property.</p></li><li><p>If the "javax.net.ssl.trustStore" system property was not specified, and if the file "&lt;java-home&gt;/lib/security/jssecacerts" exists, that file is used. </p></li><li><p>If the file "&lt;java-home&gt;/lib/security/cacerts" exists, that file is used.</p></li></ul><p>For more information, see the SUNX509 TrustManager interface documentation on the Sun Microsystems Web site.</p><p>The Java Runtime Environment allows you to set the trustStore and trustStorePassword system properties as follows: </p><div class="sampleCode"><span codeLanguage="other"><pre>java -Djavax.net.ssl.trustStore=C:\MyCertificates\storeName
java -Djavax.net.ssl.trustStorePassword=storePassword</pre></span></div><p>In this case, any application running on this JVM will use these settings as default. In order to override the default settings in your application, you should set the <span class="label">trustStore</span> and <span class="label">trustStorePassword</span> connection properties either in the connection string or in the appropriate setter method of the <a href="097434fd-2b74-411c-a5ed-eba04481dde5.htm">SQLServerDataSource</a> class.</p><p>In addition, you can configure and manage the default trust store files such as "&lt;java-home&gt;/lib/security/jssecacerts" and "&lt;java-home&gt;/lib/security/cacerts". To do that, use the JAVA "keytool" utility that is installed with the JRE (Java Runtime Environment). For more information about the "keytool" utility, see keytool documentation on the Sun Microsystems Web site.</p><h1 class="heading">Importing the Server Certificate to Trust Store</h1><div class="subsection"><p>During the SSL handshake, the server sends its public key certificate to the client. The issuer of a public key certificate is known as a Certificate Authority (CA). The client has to ensure that the certificate authority is one that the client trusts. This is achieved by knowing the public key of trusted CAs in advance. Normally, the JVM ships with a predefined set of trusted certificate authorities. </p><p>If the instance of SQL Server's SSL certificate is issued by a private certificate authority, you must add the certificate authority's certificate to the list of trusted certificates in the client computer's trust store.</p><p>In order to do that, use the JAVA "keytool" utility that is installed with the JRE (Java Runtime Environment). The following command prompt demonstrates how to use the "keytool" utility to import a certificate from a file:</p><div class="sampleCode"><span codeLanguage="other"><pre>keytool -import -v -trustcacerts -alias myServer -file caCert.cer -keystore truststore.ks</pre></span></div><p>The example uses a file named "caCert.cer" as a certificate file. You must obtain this certificate file from the server. The following steps explain how to export the server certificate to a file:</p><ol><li><p>Click Start and then Run, and type MMC. (MMC is an acronym for the Microsoft Management Console.)</p></li><li><p>In MMC, open the Certificates. </p></li><li><p>Expand Personal and then Certificates. </p></li><li><p>Right-click the server certificate, and then select All Tasks\Export. </p></li><li><p>Click Next to move past the welcome dialog box of the Certificate Export Wizard. </p></li><li><p>Confirm that "No, do not export the private key" is selected, and then click Next. </p></li><li><p>Make sure that either DER encoded binary X.509 (.CER) or Base-64 encoded X.509 (.CER) is selected, and then click Next. </p></li><li><p>Enter an export file name.</p></li><li><p>Click Next, and then click Finish to export the certificate.</p></li></ol></div></div><span id="seeAlsoSpan"><h1 class="heading">See Also</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="8e566243-2f93-4b21-8065-3c8336649309.htm">Using SSL Encryption</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="90724ec6-a9cb-43ef-903e-793f89410bc0.htm">Securing JDBC Driver Applications</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Send <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','01.00.12024.10000','%0\dThank%20you%20for%20your%20feedback.%20The%20developer%20writing%20teams%20use%20your%20feedback%20to%20improve%20documentation.%20While%20we%20are%20reviewing%20your%20feedback,%20we%20may%20send%20you%20e-mail%20to%20ask%20for%20clarification%20or%20feedback%20on%20a%20solution.%20We%20do%20not%20use%20your%20e-mail%20address%20for%20any%20other%20purpose%20and%20we%20delete%20it%20after%20we%20finish%20our%20review.%0\AFor%20further%20information%20about%20the%20privacy%20policies%20of%20Microsoft,%20please%20see%20http://privacy.microsoft.com/en-us/default.aspx.%0\A%0\d','Customer%20Feedback');">feedback</a> on this topic to Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.  All rights reserved.</a></p></span></div></div></body></html>