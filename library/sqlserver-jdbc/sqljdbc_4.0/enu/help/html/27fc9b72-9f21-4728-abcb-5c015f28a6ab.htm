<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Wrappers and Interfaces</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="27fc9b72-9f21-4728-abcb-5c015f28a6ab" /><meta name="Description" content="The Microsoft JDBC Driver for SQL Server supports interfaces that allow you create a proxy of a class, and wrappers that let you access extensions to the JDBC API that are specific to the Microsoft JDBC Driver for SQL Server through a proxy interface." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Wrappers and Interfaces</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>The Microsoft JDBC Driver for SQL Server supports interfaces that allow you create a proxy of a class, and wrappers that let you access extensions to the JDBC API that are specific to the Microsoft JDBC Driver for SQL Server through a proxy interface.</p></div><h1 class="heading">Wrappers</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>The Microsoft JDBC Driver for SQL Server supports the java.sql.Wrapper interface. This interface provides a mechanism to access extensions to the JDBC API that are specific to the Microsoft JDBC Driver for SQL Server through a proxy interface.</p><p>The java.sql.Wrapper interface defines two methods: <span sdata="langKeyword" value="isWrapperFor"><span class="keyword">isWrapperFor</span></span> and <span sdata="langKeyword" value="unwrap"><span class="keyword">unwrap</span></span>. The <span sdata="langKeyword" value="isWrapperFor"><span class="keyword">isWrapperFor</span></span> method checks whether the specified input object implements this interface. The <span sdata="langKeyword" value="unwrap"><span class="keyword">unwrap</span></span> method returns an object that implements this interface to allow access to the Microsoft JDBC Driver for SQL Server specific methods.</p><p><span sdata="langKeyword" value="isWrapperFor"><span class="keyword">isWrapperFor</span></span> and <span sdata="langKeyword" value="unwrap"><span class="keyword">unwrap</span></span> methods are exposed as follows:</p><ul><li><p><span sdata="link"><a href="71156863-3588-453e-b5a5-0573b2c1bebf.htm">isWrapperFor Method (SQLServerCallableStatement)</a></span></p></li><li><p><span sdata="link"><a href="cbbf2728-b8c8-4c35-875a-6e967c8285dc.htm">unwrap Method (SQLServerCallableStatement)</a></span></p></li><li><p><span sdata="link"><a href="09ed10eb-6e46-437b-a7c0-3c55574aad38.htm">isWrapperFor Method (SQLServerConnectionPoolDataSource)</a></span></p></li><li><p><span sdata="link"><a href="f5c9b734-2096-4ae4-a284-6b4d1b4a00d4.htm">unwrap Method (SQLServerConnectionPoolDataSource)</a></span></p></li><li><p><span sdata="link"><a href="f77af027-c021-4a17-b264-1ee592bfdd84.htm">isWrapperFor Method (SQLServerDataSource)</a></span></p></li><li><p><span sdata="link"><a href="eb8abe29-f3ec-4752-a590-1d5dc3e48f08.htm">unwrap Method (SQLServerDataSource)</a></span></p></li><li><p><span sdata="link"><a href="b0e591b1-73e2-4f90-967f-5555eadfc3f1.htm">isWrapperFor Method (SQLServerPreparedStatement)</a></span></p></li><li><p><span sdata="link"><a href="8e3ec950-3ac1-4c28-9e97-ddce3bd46578.htm">unwrap Method (SQLServerPreparedStatement)</a></span></p></li><li><p><span sdata="link"><a href="53f3291f-d43a-476b-a656-d86168dacf6c.htm">isWrapperFor Method (SQLServerStatement)</a></span></p></li><li><p><span sdata="link"><a href="ce680176-ef04-4e44-bb6c-ec50bd06e7e6.htm">unwrap Method (SQLServerStatement)</a></span></p></li><li><p><span sdata="link"><a href="d612461d-4c3f-46db-b968-ff4c80b2aa7c.htm">isWrapperFor Method (SQLServerXADataSource)</a></span></p></li><li><p><span sdata="link"><a href="d97c99b3-2224-4abb-8b32-40aff49fe759.htm">unwrap Method (SQLServerXADataSource)</a></span></p></li></ul></div><h1 class="heading">Interfaces</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Beginning in SQL Server JDBC Driver 3.0, interfaces are available for an application server to access a driver specific method from the associated class. The application server can wrap the class by creating a proxy, exposing the Microsoft JDBC Driver for SQL Server-specific functionality from an interface. The Microsoft JDBC Driver for SQL Server supports interfaces that have the Microsoft JDBC Driver for SQL Server specific methods and constants so an application server can create a proxy of the class.</p><p>The interfaces derive from standard Java interfaces so you can use the same object once it is unwrapped to access driver specific functionality or generic Microsoft JDBC Driver for SQL Server functionality.</p><p>The following interfaces are added:</p><ul><li><p><a href="030a1631-cfcd-41e0-beb5-47f93c01e8e0.htm">ISQLServerCallableStatement</a></p></li><li><p><a href="031c01e2-2c65-4fe4-9700-fdbcc7a39f30.htm">ISQLServerConnection</a></p></li><li><p><a href="ba1d3242-19ca-4321-83fe-867a4f69f1d4.htm">ISQLServerDataSource</a></p></li><li><p><a href="cf87892e-5c34-4ac6-8258-c2a81e117b26.htm">ISQLServerPreparedStatement</a></p></li><li><p><a href="002496f7-8ec0-4267-b4e6-ba095e2ef306.htm">ISQLServerResultSet</a></p></li><li><p><a href="7f83b514-6e76-4f37-baf3-a10db2010e7c.htm">ISQLServerStatement</a></p></li></ul></div><h1 class="heading">Example</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><h1 class="heading">Description</h1><div class="subsection"><p>This sample demonstrates how to access to a Microsoft JDBC Driver for SQL Server-specific function from a <b>DataSource</b> object. This <b>DataSource</b> class may have been wrapped by an application server. To access the JDBC driver-specific function or constant, you can unwrap the datasource to an <b>ISQLServerDataSource</b> interface and use the functions declared in this interface.</p></div><h1 class="heading">Code</h1><div class="subsection"><div class="sampleCode"><span codeLanguage="other"><pre>import javax.sql.*;
import java.sql.*;
import com.microsoft.sqlserver.jdbc.*;

public class UnWrapTest {
   public static void main(String[] args) {
      // This is a test.  This DataSource object could be something from an appserver 
      // which has wrapped the real SQLServerDataSource with its own wrapper
      SQLServerDataSource ds = new SQLServerDataSource();
      checkSendStringParametersAsUnicode(ds);
   }

   // Unwrap to the ISQLServerDataSource interface to access the getSendStringParametersAsUnicode function
   static void checkSendStringParametersAsUnicode(DataSource ds) {
      try {
         final ISQLServerDataSource sqlServerDataSource = ds.unwrap(ISQLServerDataSource.class);
         boolean sendStringParametersAsUnicode = sqlServerDataSource.getSendStringParametersAsUnicode();

         System.out.println("Send string as parameter value is:-" + sendStringParametersAsUnicode);

      } catch (SQLException sqlE) {
         System.out.println("Exception:-" + sqlE);
      }
   }
}</pre></span></div></div></div><span id="seeAlsoSpan"><h1 class="heading">See Also</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7802328d-4d23-4775-9573-4169b127d258.htm">Understanding the JDBC Driver Data Types</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Send <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','01.00.12024.10000','%0\dThank%20you%20for%20your%20feedback.%20The%20developer%20writing%20teams%20use%20your%20feedback%20to%20improve%20documentation.%20While%20we%20are%20reviewing%20your%20feedback,%20we%20may%20send%20you%20e-mail%20to%20ask%20for%20clarification%20or%20feedback%20on%20a%20solution.%20We%20do%20not%20use%20your%20e-mail%20address%20for%20any%20other%20purpose%20and%20we%20delete%20it%20after%20we%20finish%20our%20review.%0\AFor%20further%20information%20about%20the%20privacy%20policies%20of%20Microsoft,%20please%20see%20http://privacy.microsoft.com/en-us/default.aspx.%0\A%0\d','Customer%20Feedback');">feedback</a> on this topic to Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.  All rights reserved.</a></p></span></div></div></body></html>